## _Глава №7_

# ***Раскрытие Секретов Внутренней Работы Биткойна: математика, Мемпул и UTXO***

- [**7.0** Решение Проблемы Двойных Расходов: Понимание Решения Биткойна](https://github.com/BabaevDaniel/Bitcoin-Diploma-Russian-Version/blob/main/Translated-text/19.Chapter-7.md#70-%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC%D1%8B-%D0%B4%D0%B2%D0%BE%D0%B9%D0%BD%D1%8B%D1%85-%D1%80%D0%B0%D1%81%D1%85%D0%BE%D0%B4%D0%BE%D0%B2-%D0%BF%D0%BE%D0%BD%D0%B8%D0%BC%D0%B0%D0%BD%D0%B8%D0%B5-%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D1%8F-%D0%B1%D0%B8%D1%82%D0%BA%D0%BE%D0%B9%D0%BD%D0%B0)    
- [**7.1** Отслеживание Пути Вашей Монеты](https://github.com/BabaevDaniel/Bitcoin-Diploma-Russian-Version/blob/main/Translated-text/19.Chapter-7.md#71-%D0%BE%D1%82%D1%81%D0%BB%D0%B5%D0%B6%D0%B8%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-%D0%BF%D1%83%D1%82%D0%B8-%D0%B2%D0%B0%D1%88%D0%B5%D0%B9-%D0%BC%D0%BE%D0%BD%D0%B5%D1%82%D1%8B)    
- [**7.2** Безопасность и Секретность](https://github.com/BabaevDaniel/Bitcoin-Diploma-Russian-Version/blob/main/Translated-text/19.Chapter-7.md#72-%D0%B1%D0%B5%D0%B7%D0%BE%D0%BF%D0%B0%D1%81%D0%BD%D0%BE%D1%81%D1%82%D1%8C-%D0%B8-%D1%81%D0%B5%D0%BA%D1%80%D0%B5%D1%82%D0%BD%D0%BE%D1%81%D1%82%D1%8C)    
- [**7.3** "Мемпул" или Бассейн Памяти: Понимание Резервуара Хранения Биткойн-Транзакций](https://github.com/BabaevDaniel/Bitcoin-Diploma-Russian-Version/blob/main/Translated-text/19.Chapter-7.md#73-%D0%BC%D0%B5%D0%BC%D0%BF%D1%83%D0%BB-%D0%B8%D0%BB%D0%B8-%D0%B1%D0%B0%D1%81%D1%81%D0%B5%D0%B9%D0%BD-%D0%BF%D0%B0%D0%BC%D1%8F%D1%82%D0%B8-%D0%BF%D0%BE%D0%BD%D0%B8%D0%BC%D0%B0%D0%BD%D0%B8%D0%B5-%D1%80%D0%B5%D0%B7%D0%B5%D1%80%D0%B2%D1%83%D0%B0%D1%80%D0%B0-%D1%85%D1%80%D0%B0%D0%BD%D0%B5%D0%BD%D0%B8%D1%8F-%D0%B1%D0%B8%D1%82%D0%BA%D0%BE%D0%B9%D0%BD-%D1%82%D1%80%D0%B0%D0%BD%D0%B7%D0%B0%D0%BA%D1%86%D0%B8%D0%B9)    
  - [**7.3.1** Классное Упражнение: "В Режиме Ожидания": Изучение Неподтвержденных Транзакций в Сети Биткойн](https://github.com/BabaevDaniel/Bitcoin-Diploma-Russian-Version/blob/main/Translated-text/19.Chapter-7.md#731-%D0%BA%D0%BB%D0%B0%D1%81%D1%81%D0%BD%D0%BE%D0%B5-%D1%83%D0%BF%D1%80%D0%B0%D0%B6%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5-%D0%B2-%D1%80%D0%B5%D0%B6%D0%B8%D0%BC%D0%B5-%D0%BE%D0%B6%D0%B8%D0%B4%D0%B0%D0%BD%D0%B8%D1%8F-%D0%B8%D0%B7%D1%83%D1%87%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BD%D0%B5%D0%BF%D0%BE%D0%B4%D1%82%D0%B2%D0%B5%D1%80%D0%B6%D0%B4%D0%B5%D0%BD%D0%BD%D1%8B%D1%85-%D1%82%D1%80%D0%B0%D0%BD%D0%B7%D0%B0%D0%BA%D1%86%D0%B8%D0%B9-%D0%B2-%D1%81%D0%B5%D1%82%D0%B8-%D0%B1%D0%B8%D1%82%D0%BA%D0%BE%D0%B9%D0%BD)    
- [**7.4** За Блоками: Тайна Биткойн-Скриптов](https://github.com/BabaevDaniel/Bitcoin-Diploma-Russian-Version/blob/main/Translated-text/19.Chapter-7.md#74-%D0%B7%D0%B0-%D0%B1%D0%BB%D0%BE%D0%BA%D0%B0%D0%BC%D0%B8-%D1%82%D0%B0%D0%B9%D0%BD%D0%B0-%D0%B1%D0%B8%D1%82%D0%BA%D0%BE%D0%B9%D0%BD-%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82%D0%BE%D0%B2)    
  - [**7.4.1** Техническое Погружение в Биткойн-Транзакции](https://github.com/BabaevDaniel/Bitcoin-Diploma-Russian-Version/blob/main/Translated-text/19.Chapter-7.md#741-%D1%82%D0%B5%D1%85%D0%BD%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%BE%D0%B5-%D0%BF%D0%BE%D0%B3%D1%80%D1%83%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5-%D0%B2-%D0%B1%D0%B8%D1%82%D0%BA%D0%BE%D0%B9%D0%BD-%D1%82%D1%80%D0%B0%D0%BD%D0%B7%D0%B0%D0%BA%D1%86%D0%B8%D0%B8)    



_______________________________________________________________________________________

Вы видите там эту длинную цепочку единиц и нулей? Это называется случайным числом, и если мы преобразуем его в нашу обычную десятичную систему, оно станет числом, состоящим более чем из 70 цифр, а это даже больше атомов, чем в нашей Вселенной! Но мы можем использовать другую систему для более короткого представления этого числа и называть это личным ключом.

Что действительно замечательно в этом личном ключе, так это то, что он уникален, а это означает, что он никогда раньше не использовался и никогда больше не появится, как только вы покинете эту страницу или создадите новую. Это все равно, что подбросить 256 монет подряд и дважды получить один и тот же результат – невозможно!

Безопасность Биткойна зависит от того, является ли этот личный ключ конфиденциальный и его трудно угадать. Если кто-то другой заполучит его или вы потеряете его, вы потеряете все свои деньги навсегда. Так что берегите его!

Но как на самом деле работает Биткойн? Посмотрите следующее видео, чтобы лучше понять.

На данный момент мы узнали об истории денег и революционной идее технологии блокчейн, а также изучили основы Биткойна — первой в мире децентрализованной цифровой валюты. Но как Биткойн предотвращает мошенничество и гарантирует, что люди не смогут потратить одни и те же деньги дважды?

Правда в том, что когда вы отправляете биткойны кому-то другому, вы должны сказать «да, я одобряю это» своим личным ключом. Затем сеть говорит: «Круто, позвольте мне еще раз проверить, что это законно», и проверяет подпись, чтобы убедиться, что все в порядке, прежде чем отправлять биткойны.

Translate pictures



_______________________________________________________________________________________

Именно здесь в игру вступает магия UTXO, криптографии с публичным ключом, хеширования, сценариев и мемпула. Точно так же, как отпечаток пальца гарантирует, что никто другой не сможет использовать вашу личность, хэши в Биткойне гарантируют, что транзакции не могут быть изменены. Скрипты подобны правилам игры: они следят за тем, чтобы транзакции соответствовали определенным условиям. UTXO похожи на строительные блоки головоломки, отслеживающие все деньги в вашем виртуальном кошельке. Мемпул действует как зона хранения, гарантируя, что все транзакции проверяются перед добавлением в блокчейн. Итак, давайте углубимся и узнаем, как Биткойн решает проблему двойных расходов и обеспечивает целостность каждой транзакции в своей сети.


### ***7.0 Решение Проблемы Двойных Расходов: Понимание Решения Биткойна***    

Напомните, что такое «проблема двойных расходов»?

Как мы уже видели, личные, публичные ключи и транзакции с биткойнами представлены серией случайных чисел и букв, которые можно просмотреть на любом устройстве с доступом в Интернет.

Кроме того, большая часть информации, связанной с этими транзакциями, обычно передается с использованием системы числовых обозначений, известной как шестнадцатеричные числа.

Двойные траты...
Биты легче копировать, чем бумагу!

Это означает, что часто можно увидеть строки 64-значных шестнадцатеричных чисел, состоящих из букв (A-F) и цифр (0–9), например:

Так как же нам на самом деле запретить кому-либо копировать и вставлять свои биткойны и тратить их несколько раз, как это было бы с электронным письмом или фотографией?

Как нам достичь консенсуса о том, кому и какими деньгами принадлежат без центральной власти?

Хеширование и код. Давайте объясним.



_______________________________________________________________________________________

Представьте, что у вас есть 1 биткойн, и вы хотите отправить его своему другу в качестве подарка на день рождения. Вы отправляете биткойны на адрес своего друга, но затем понимаете, что задолжали деньги своему бывшему парню и вместо этого должны были отправить биткойны ему. В момент паники вы решаете схитрить и создать новую транзакцию, чтобы отправить тот же 1 биткойн своему бывшему парню. Это то, что мы называем «двойными тратами».

Но подождите, как сеть предотвращает это? Это просто. Узлы в сети обнаруживают конфликтующие транзакции и разрешают только проведения одной транзакции на основе набора правил, известных как «правила консенсуса». В этом случае вполне вероятно, что транзакция вашему бывшему парню будет отклонена, поскольку она была отправлена после исходной транзакции вашему другу. Однако это всего лишь вопрос удачи, какую транзакцию первым подхватит майнер.

Благодаря блокчейну каждый в сети может договориться о текущем состоянии реестра. Это помогает предотвратить двойные расходы и мошенничество, делая систему безопасной и заслуживающей доверия, подобно цифровой версии «системы чести». Итак, в следующий раз, когда вы отправите биткойны, вы можете расслабиться, зная, что сеть вас поддержит.

Так как же Биткойн на самом деле решает эту проблему? Что ж, давайте узнаем.
- Биткойн предотвращает двойные расходы, реализуя механизм подтверждения и поддерживая универсальный реестр (блокчейн).
- Транзакции добавляются в блокчейн в хронологическом порядке с отметкой времени.
- Чтобы предотвратить двойные траты, в блокчейн включается только первая транзакция, получившая достаточное количество подтверждений (обычно 6), а остальные отбрасываются.
- Транзакции в блокчейне необратимы и их невозможно подделать.

Узел добычи биткойнов отклоняет транзакцию из мемпула

ОТКЛОНЕННЫЙ



_______________________________________________________________________________________

Когда какая-либо транзакция инициируется, любой узел может проверить её в сети, выполнив несколько простых шагов:

1. Сначала узел проверит, что транзакция правильно подписана личным ключом отправителя, что гарантирует, что транзакция является законной и не подделана.
2. Далее узел проверит, достаточно ли у отправителя средств для завершения транзакции. Это делается путем проверки баланса отправителя в реестре блокчейна.
3. Наконец, узел также проверит входные и выходные данные транзакции, гарантируя, что входные данные, потраченные в транзакции, еще не потрачены в другой транзакции и что выходные данные не превышают общий объем запаса.

Как мы увидим, комбинация криптографии с публичным ключом и системы UTXO (вывод неизрасходованных транзакций) используется в Биткойне для проверки подлинности транзакций и предотвращения мошенничества без центрального органа. Криптография с публичным ключом обеспечивает безопасную связь и переводы средств, а UTXO ведет учет всех средств в сети и предотвращает двойное расходование.

UTXO, что означает «Выход неизрасходованных транзакций», представляет собой просто запись всех доступных средств в сети, которые еще не были потрачены.


### ***7.1 Отслеживание Пути Вашей Монеты***    

В Биткойне транзакции работают так же, как разбиение большой купюры на более мелкие и раздача их разным людям. Сдача, которую вы получаете от транзакции, называется неизрасходованным выходом и может использоваться в качестве входа для новой транзакции. Выходы в транзакциях Биткойн могут быть потрачены или неизрасходованы, а неизрасходованные выходы считаются ценными, поскольку их можно использовать в новых транзакциях.

- Думайте об этом как об использовании нескольких подарочных карт для оплаты покупки. Подарочные карты от предыдущих транзакций действуют как входные данные, а получаемая вами сдача представлена новой подарочной картой с оставшейся суммой. Это похоже на то, как транзакции биткойнов работают с UTXO.

Что такое UTXO?

Баланс кошелька представляет собой сумму всех UTXO пользователя. UTXO используются для отслеживания владения биткойнами в сети. Когда транзакция совершается, она создает новые UTXO, а когда транзакция тратится, существующие UTXO используются.

UTXO — это цифровые монеты в мире Биткойн. Это сдача, которую вы получите обратно после того, как потратите немного биткойнов.



_______________________________________________________________________________________

Натали хочет отправить Роберто 0,5 BTC

1 BTC UTXO (Адрес)
Квитанция об идентификационном номере налогоплательщика
scriptSig (подтверждение права собственности)

ВХОДЫ
ВЫХОДЫ

Новый UTXO B 0,5 BTC
Новый 0,4 BTC UTXO C

Новый UTXO 0,1 также отправляется майнеру.

Роберто получает в качестве оплаты новый UTXO
Натали также получает новый UTXO в качестве «сдачи».


Как UTXO работают в биткойн-транзакциях

Когда совершается транзакция, количество отправленных биткойнов делится на несколько выходов, каждый из которых связан с определенным адресом.

- Отправляя кому-либо биткойны, вы будете использовать один или несколько выходов неизрасходованных транзакций (UTXO) в качестве источника средств. При необходимости эти UTXO будут объединены для создания нового вывода, принадлежащего получателю транзакции. Этот новый вывод, или UTXO, станет собственностью получателя и может быть использован в качестве источника средств в будущей транзакции. Эта цепочка UTXO создает прозрачную и отслеживаемую историю всех биткойн-транзакций в блокчейне, начиная с самого первого блока.

Кошелек Алисы. Транзакция. Разблокировать Вводы. Блокировка Вводы. Кошелек Боба. Кошелек Алисы после завершения транзакции.

- Например, если кто-то хочет отправить 2 биткойна, но имеет UTXO стоимостью 5 биткойнов, разница в 3 биткойна отправляется обратно отправителю как «сдача». Это изменение представляет собой новый UTXO для отправителя и может быть потрачено в будущей транзакции.

- В этом примере Алиса отправляет Бобу 5 BTC, оставляя часть себе. Она объединяет 6 биткойнов из своих четырех UTXO, что в сумме составляет 23 биткойна, и отправляет 5 Бобу и 0,99 обратно себе с комиссией 0,01 за обработку. Затем транзакция добавляется в блокчейн, обновляя все узлы копией обновленного реестра UTXO. Если Алиса затем попытается отправить 23 BTC в Ximena в отдельной транзакции, узлы отклонят её, поскольку часть вывода уже потрачена.

Если кто-то попытается использовать потраченные выходные данные в своей транзакции, они, скорее всего, будут отклонены сетевыми узлами. Это связано с тем, что эти узлы поддерживают копию одного и того же набора баз данных и могут легко достичь консенсуса, проверяя баланс каждого адреса перед проверкой любой новой транзакции. Это обеспечивает целостность и достоверность транзакций в сети.



_______________________________________________________________________________________

Давайте посмотрим на другой пример:

Только тот, у кого есть личный ключ для адреса, может получить доступ к UTXO, хранящимся по этому адресу. Например, если у Эвелин есть личный ключ для адреса №1, она увидит в своем кошельке 0,5 биткойна. Если у Сало есть личный ключ для адреса №2, он увидит в своем кошельке 2,3 биткойна.

Когда Эвелин отправляет 0,3 биткойна к Сало, её кошелёк генерирует новый личный ключ и адрес (#3). Исходный UTXO по адресу № 1 расходуется и создаются два новых UTXO: один для адреса Сало с 0,3 биткойна и один для нового адреса Эвелин с 0,2 биткойна. После того, как эта транзакция записана в реестре, в кошельке Сало отображается 2,6 биткойна, а в кошельке Эвелин — 0,2 биткойна.

Ниже приведен скриншот реальной транзакции, в которой имеется только один ввод. Однако в более общем случае стартовый баланс может представлять собой сумму нескольких UTXO, накопленных человеком в результате предыдущих транзакций.

Какие наблюдения вы можете сделать? Совпадают ли вводы с выводами? Можете ли вы описать детали Транзакции? Есть ли связь между двумя скриншотами? И какая транзакция произошла первой?



_______________________________________________________________________________________

Обычно израсходованные выводы отображаются красным цветом, а неизрасходованные — зеленым. Это цветовое кодирование обеспечивает визуальный способ быстрой идентификации потраченных и неизрасходованных выводов, что может быть полезно для отслеживания транзакций и понимания потока средств в блокчейне.


### ***7.2 Безопасность и Секретность***    

Пожалуйста, не пугайтесь предстоящих технических терминов и математических концепций. Мы понимаем, что не все увлекаются математикой, но вы можете удивить себя и увидеть, что даже самые сложные идеи можно понять, приложив немного усилий.

Что такое функция, а точнее, что такое односторонняя функция?

Функция подобна машине, которая берет некоторую информацию и превращает её во что-то новое. Информация, которую вы передаете функции, называется вводными данными. Новая информация, которую создает функция, называется выводными данными. Функции помогают компьютерам выполнять задачи и решать проблемы.

Вводы.
Функциональная машина.
Выводы.

Воспринимайте это как рецепт приготовления салата. Рецепт (или функция) говорит вам, какие ингредиенты использовать и как их смешать, чтобы приготовить салат. Вы можете добавлять разные ингредиенты, но на выводе по рецепту всегда будет салат. Функции можно использовать, чтобы сделать работу проще и эффективнее.

Таким образом, этот рецепт представляет собой функцию, которая принимает ингредиенты в качестве вводные данные и генерирует перемешанный салат в качестве выводные данные.



_______________________________________________________________________________________

В Биткойне функции используются для выполнения транзакций. Мы уже знаем, что транзакции в Биткойне — это, по сути, передача стоимости с одного адреса на другой. Для выполнения транзакции используется ряд криптографических функций для проверки транзакции и обновления состояния блокчейна Биткойн, который представляет собой децентрализованный реестр, в котором отслеживаются все транзакции.

Функции, используемые в транзакции Биткойн, включают проверку подлинности вводных данных транзакции, проверку наличия достаточных средств у отправителя и обновление балансов соответствующих адресов. Как только транзакция проверена и добавлена в блокчейн, она становится частью постоянной записи всех транзакций в сети.

- Односторонняя функция использует набор инструкций для обработки информации и превращает её во что-то новое, как рецепт смузи превращает ингредиенты в новый напиток. Но так же, как вы не можете размешать коктейль, чтобы вернуть исходные ингредиенты, вы не можете обратить вспять одностороннюю функцию, чтобы вернуть исходную информацию.

Криптография с публичным ключом, частью которой является публичный ключ, основана на использовании односторонних функций, которые затрудняют определение личного ключа из публичного ключа. Найти личный ключ из публичного ключа не совсем «невозможно», но сделать это чрезвычайно сложно, и для выполнения этой задачи потребуется непомерное количество времени и вычислительной мощности.

- Найти личный ключ из публичного ключа в Биткойне — это все равно, что пытаться найти иголку в стоге сена размером с футбольное поле. Иголка представляет личный ключ, а стог сена — все возможные публичные ключи.

Точно так же односторонние функции спроектированы так, чтобы быть необратимыми и не поддающимися расшифровке.

Что такое хеш-функция?

Хеширование похоже на отпечаток пальца для цифровых данных. Это процесс преобразования цифрового сообщения в код фиксированной длины, который служит уникальным идентификатором.

Точно так же, как отпечаток пальца может идентифицировать человека, хэш может идентифицировать цифровое сообщение. Хэши используются во многих приложениях, включая транзакции Биткойн.



_______________________________________________________________________________________

Как хеширование используется в биткойн-транзакциях

В Биткойне каждая транзакция хешируется перед добавлением в блокчейн. Хэш действует как подпись транзакции, проверяя, что транзакция действительна и не была подделана. Если кто-то попытается изменить хотя бы одну букву в транзакции, хеш будет совершенно другим, что предупредит других об изменении.

Роль хеширования в обеспечении безопасности

Хеширование имеет важное значение для безопасности сети Биткойн. Используя хэши для идентификации транзакций, сеть может обнаружить любую попытку изменить транзакцию или манипулировать ею. Это помогает предотвратить мошенничество и обеспечить точную запись всех транзакций в блокчейн.

Хэш-функция — это тип односторонней функции, которая принимает вводные данные (называемые «сообщением» или «данными») и преобразует их в числовое представление, называемое «хешем». Выводной хеш уникален для вводных данных, поэтому даже небольшое изменение вводных данных приводит к совершенно другому хешу.

Текст.
Хэш-функция.
Хэш-значение.
Данные произвольной длины.
Сообщение.
Хэш-функция.
Хэш фиксированной длины (дайджест)

Хэш-функция подобна машине секретного кода. Он принимает сообщение и превращает его в код.

- Код всегда выглядит одинаково для одного и того же сообщения. Если вы хоть немного измените сообщение, код будет совершенно другим. Это помогает компьютерам запоминать данные и проверять, было ли что-то изменено.

Мгновенно сгенерируйте хэш SHA256 любой строки или вводного значения. Хэш-функции используются как односторонние методы.



_______________________________________________________________________________________

Ввод
Кошка.jpg

Криптографическая хэш-функция.
В одну сторону.

Вывод
32-битный хэш

Пропал ус! Теперь у нее есть повод злиться.

Полностью отличается от предыдущего хеша.


Выводные данные, или хэш, всегда имеют одинаковую длину, независимо от длины исходной информации.

Биткойн использует несколько конкретных типов хеш-функций, называемых SHA-256 и RIPEMD160. Несколько примеров ниже:
- Обратите внимание, что точка во втором вводном файле полностью меняет выводные данные по сравнению с первым.
- Третий вводной файл представляет собой огромный файл, но выводной файл имеет ту же фиксированную длину, что и два других.

SHA256 хеш строки hello world
SHA256 хеш строки hello world.
Хэш SHA256 загружаемого ISO-файла Ubuntu 18.10


Хеширование также можно рассматривать как музыкальную партитуру, отражающую суть музыкального произведения. Точно так же, как партитура является уникальным представлением мелодии, хэш-функция является уникальным представлением фрагмента данных. Сравнивая партитуру музыкального произведения с реальным исполнением, музыкант может определить, является ли исполнение точным. Аналогично, сравнивая значение хеш-функции полученных данных с исходным значением хеш-функции, можно определить, были ли данные изменены во время передачи.




_______________________________________________________________________________________

- Точно так же, как небольшое отклонение в музыкальном исполнении может привести к тому, что оно будет звучать иначе, даже малейшее изменение исходных данных приведет к другому значению хеш-функции. Это делает хеширование мощным инструментом для обеспечения целостности и подлинности цифровой информации.

Процесс кодирования публичного ключа посредством хеширования используется для повышения безопасности информации путем преобразования её в нечитаемый формат фиксированной длины. Биткойн использует алгоритмы SHA-256 и Ripemd-160 для создания публичных адресов. Полученный результат служит уникальным идентификатором публичного ключа и помогает обеспечить целостность и безопасность транзакций, хранящихся в блокчейне. При таком кодировании информации, неавторизованным лицам становится сложнее получить доступ к данным и манипулировать ими.

Это ваш биткойн

По этой ссылке вы найдете еще один генератор хэшей, где сможете опробовать его самостоятельно.

Хеширование.
Хэш-функция принимает любые вводные данные и выдает выводные данные фиксированной длины (хэш).

Ингредиенты.
Хэш-функция.
Смузи.

- Детерминированный. Из одних и тех же ингредиентов всегда получается один и тот же коктейль.
- Сопротивление перед изображением. Вы не сможете склеить клубнику, когда вам дают смузи.
- Корреляционное сопротивление. Немного изменив ингредиенты, получится совершенно другой смузи.
- Устойчивость к столкновениям. Трудно найти разные ингредиенты для смузи, из которых получится один и тот же.
- Скорость и проверяемость. Бросаем фрукты в миксер. Это быстро, и на выходе обязательно получится смузи.




_______________________________________________________________________________________

### ***7.3 "Мемпул" или Бассейн Памяти: Понимание Резервуара Хранения Биткойн-Транзакций***    

Что такое Мемпул?

Мемпул похож на зал ожидания для транзакций в сети Биткойн. Когда транзакция совершается, она сначала добавляется в мемпул узла, перед тем как она проверяется и добавляется в блокчейн.


Мемпул — это место, где транзакции ожидают подтверждения в блоке.

ставка комиссии

Когда узел впервые получает транзакцию от однорангового узла, он должен убедиться, что транзакция легитимна. Никто не хочет ошибочных или обманных транзакций.

Синхронизация мемпула позволяет узлам делиться своими транзакциями с другими узлами, отправляя сообщение, содержащее список проверенных транзакций в мемпуле.

Майнер №1

Обновить мемпул

Обмен данными

Майнер №2


Основная цель мемпула заключается в следующем:

1. Ретрансляция неподтвержденных транзакций.
2. Предоставлять майнерам транзакции для майнинга.

Принять в пул памяти (ATMP) включает в себя проверку таких вещей, как:

- Есть ли у меня уже эта транзакция?
- Есть ли конфликт с другой транзакцией в мемпуле?
- Покрывают ли поступающие биткойны количество выходящих биткойнов?
- Доказывают ли подписи, что предыдущие выводы могут быть потрачены?
- Достаточно ли биткойнов для комиссий?




_______________________________________________________________________________________

Как транзакции проверяются и добавляются в мемпул.

Полный узел проверяет все транзакции, чтобы убедиться, что они действительны и не использовались ранее. Если транзакция прошла успешно, узел проверит её и добавит в свой пул памяти. Затем он поделится им с другими узлами для двойной проверки. Наконец, если большинство согласится, он будет удален из общего мемпула и станет постоянной частью блокчейна.

Транзакции в сети Биткойн извлекаются из мемпула и подтверждаются при включении в блок, который затем добавляется в блокчейн. Однако есть несколько причин, по которым транзакция может не быть подтверждена через 72 часа:

1. Низкая комиссия: Транзакции с низкой комиссией могут обрабатываться недостаточно быстро, поскольку майнеры с большей вероятностью выберут транзакции с более высокими комиссиями для включения в свои блоки.
2. Перегрузка сети: Если сеть перегружена, может возникнуть задержка в подтверждении транзакций, даже если они имеют высокую комиссию.
3. Попытка двойного расходования: Если злоумышленник попытается удвоить расходы, его транзакция может быть отклонена сетью.
4. Неверные или неполные данные: Если транзакция содержит неверные или неполные данные, она может быть отклонена сетью.
5. Неверная транзакция: Если транзакция имеет неверный формат, она может быть отклонена сетью.

Чтобы избежать отклонения транзакций, рекомендуется включить достаточно высокую комиссию, чтобы обеспечить своевременную обработку транзакции, а также дважды проверить правильность всех данных в транзакции перед ее отправкой.

DDoS-атака (распределенный отказ в обслуживании) — это попытка сделать сеть недоступной для пользователей, перегружая ее слишком большим трафиком из нескольких источников. Эта атака направлена на нарушение нормального трафика веб-сайта или службы, перегружая его фальшивым трафиком, что затрудняет или делает невозможным доступ к нему реальных пользователей.


### _7.3.1 Классное Упражнение: "В Режиме Ожидания": Изучение Неподтвержденных Транзакций в Сети Биткойн_    

Классное упражнение. Следуйте следующим инструкциям:

1. Посетите сайт https://bits.monospace.live/



_______________________________________________________________________________________

2. Найдите неподтвержденную транзакцию и нажмите на нее.
- Какую информацию вы можете найти? Можете ли вы проследить историю происхождения биткойнов?
- Сколько адресов вы видите?
- Что означает ввод и вывод?
- Можете ли вы следить за UTXO?
- Вы узнаете, какой BTC был потрачен?
- Соответствует ли входное значение выходному?
- Взимается ли комиссия за каждую транзакцию?
- Кому идет гонорар?
- Это справедливо?
- Кто платит пошлину?
- Можете ли вы определить, сколько биткойнов было переведено с одного адреса на другой?

3. Запишите TxID, размер комиссии, комиссию и общую сумму транзакции в блокноте.
4. При желании проанализируйте другие транзакции и сравните их с первой по сумме, уплаченной комиссии и вероятности включения в следующий блок.
5. Рассмотрим, что означает, что блок «майнен», а транзакция — «неподтверждена».
6. Будьте готовы обсудить эти наблюдения и вопросы на следующем классе.


### ***7.4 За Блоками: Тайна Биткойн-Скриптов***    

Скрипт — это язык программирования, используемый в Биткойне для создания смарт-контрактов и автоматизации транзакций. Чтобы понять скрипт, полезно представить его как набор инструкций, которые сообщают сети Биткойн, что делать с конкретной транзакцией.

Смарт-контракт — это самоисполняющийся контракт, условия которого между покупателем и продавцом записаны непосредственно в строках кода. Код и содержащиеся в нем соглашения существуют в сети блокчейн и применяются автоматически.

- Думайте об этом как о торговом автомате. Вы кладете деньги, делаете выбор, и автомат автоматически выдает вам товар. Точно так же смарт-контракт автоматически выполняет условия соглашения между двумя сторонами без необходимости использования посредников, таких как юристы или банки.

Например, смарт-контракт может использоваться для представления финансового соглашения, такого как кредит или облигация. Условия соглашения, такие как процентная ставка и график погашения, закодированы в договоре. При выполнении оговоренных условий договор автоматически исполняет условия и осуществляет перевод средств.




_______________________________________________________________________________________

Ключевые преимущества смарт-контрактов заключаются в том, что они прозрачны, безопасны и самоисполняются, что может помочь снизить затраты и риски, связанные с традиционными контрактными процессами. Кроме того, поскольку они существуют в децентрализованной сети, они устойчивы к несанкционированному вмешательству или помехами, что делает их более безопасным и заслуживающим доверия способом проведения транзакций.

Аналогичным образом, Биткойн использует скрипт, чтобы убедиться, что определенные условия выполняются перед обработкой транзакции.

Хотя другие сети блокчейнов, такие как Эфириум, также поддерживают смарт-контракты и программируемые транзакции, они используют разные языки программирования и подходы для обеспечения соблюдения правил и условий транзакций. Только Биткойн использует скрипт.

Скрипт — это очень простой язык программирования, но он достаточно мощный, чтобы обрабатывать широкий спектр транзакций. Например, его можно использовать для создания транзакций с несколькими подписями, когда несколько человек должны подписать транзакцию, прежде чем она сможет быть обработана, или для создания смарт-контракта, где транзакция автоматически выполняется при выполнении определенных условий.

Хотя скрипт может показаться сложным, основная идея, лежащая в его основе, на самом деле довольно проста. Используя скрипты, сеть Биткойн может автоматически обеспечивать соблюдение правил и условий транзакций, что делает её безопасным и эффективным способом передачи ценностей.


Как скрипт используются в биткойн-транзакциях

- Представьте, что у вас есть ряд монет, и вы хотите рассортировать их по разным ячейкам, например, положить монеты в разные копилки. Важен порядок, в котором вы кладете монеты в слоты. Это похоже на то, как передаются сатоши в транзакции. Вводы похожи на ряд монет, а выводы — это слоты, ожидающие приема монеты. Чтобы распределить монеты по слотам, вы перебираете каждую монету в ряду по порядку и помещаете каждую в первый доступный слот. Это называется «первым пришел — первым вышел» или FIFO, что означает, что первая монета в ряду попадает в первый доступный слот и так далее.

Пустой стек
Толкнуть
Выскочил

- Скрипты работают в системе, основанной на стеке, где инструкции обрабатываются в порядке их появления, сверху вниз. Концепция аналогична стопке пластин, где вы можете получить доступ только к той пластине, которая находится на вершине стека.



_______________________________________________________________________________________

Базовая биткойн-транзакция использует как минимум один «скрипт блокировки» и один «скрипт разблокировки», чтобы определить, кто может получить доступ к средствам на определенном адресе кошелька. Скрипт блокировки можно рассматривать как список инструкций, описывающих, как получатель средств может получить к ним доступ, в то время как сценарий разблокировки разблокирует средства.

Ввод
Вывод
Скрипт блокировки
Скрипт раэблокировки
Результат стека = 1
(Скрипт действителен)

- Думайте о Скрипте как о рецепте выпечки торта. Точно так же, как вам нужно выполнить шаги рецепта, чтобы приготовить торт, компьютер должен следовать инструкциям в Скрипте в определенном порядке, чтобы передать право собственности на биткойны.

Используя скрипты блокировки и разблокировки, а также личных и публичных ключей, можно безопасно отслеживать и проверять право собственности и передачу UTXO.


### _7.4.1 Техническое Погружение в Биткойн-Транзакции_    

Скрипт блокировки хранит адрес получателя и проверяет, был ли использован правильный личный ключ. Это гарантирует, что личные ключи остаются конфиденциальными и могут быть надежно защищены.

Чтобы разблокировать средства, отправитель должен продемонстрировать право собственности, создав цифровую подпись с помощью своего личного ключа, тем самым подтвердив владение адресом.

проверить личный ключ
Скрипт блокировки

Вывод (биткойн UTXO) заблокирован по этому адресу (1EUX…), и только правильный личный ключ сможет его разблокировать.




_______________________________________________________________________________________

Например, предположим, что вы хотите отправить немного биткойнов своему другу, но хотите убедиться, что ваш друг сможет потратить их только после определенной даты. Вы можете использовать скрипт Биткойна, чтобы определить это условие, которое известно как «временной замок». При создании транзакции вы включаете скрипт, определяющий условие временного замка. Когда ваш друг получит биткойны, он сможет потратить их только по истечении указанной даты.

скрипт разблокировки.
цифровая подпись.

Биткойн-скрипт также можно использовать для создания более сложных условий расходования биткойнов, таких как транзакции с несколькими подписями, которые требуют, чтобы несколько сторон аутентифицировали транзакцию, прежде чем её можно будет потратить. Это может быть полезно в ситуациях, когда транзакцию необходимо одобрить нескольким сторонам.

адрес.
Личный ключ.
скрипт блокировки.
скрипт разблокировки.

CHECKPRIVATEKEY — это функция, которая проверяет, соответствует ли адрес правильному личнаму ключу.

CHECKSIG проверяет, что транзакция была одобрена владельцем личного ключа, который соответствует публичному ключу, использованному для подписи транзакции.

Проще говоря, скрипт помогает обеспечить безопасность и надежность транзакций Биткойн, используя личные и публичные ключи для проверки права собственности и перевода средств. Различные методы транзакций имеют разные уровни безопасности. Некоторые раскрывают публичный ключ получателя во время транзакции, что делает его уязвимым для кражи, если личный ключ когда-либо будет взломан. Другие скрывают публичный ключ, обеспечивая более высокий уровень безопасности.





_________________________________________________________________________________________

В следующей главе мы углубимся в процесс майнинга и роль майнеров в сети Биткойн. Мы рассмотрим, как они проверяют транзакции, создают новые блоки и получают вознаграждение за свои усилия.

Оставайтесь с нами, чтобы получить полное представление о том, как работает Сеть Биткойн!
